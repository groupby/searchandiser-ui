/*!
 * ******
 * DO NOT UPDATE LIBRARY UNTIL WE CAN HANDLE MULTIPLE ENHANCED ECOMMERCE TRANSACTIONS
 * ******
 * Google Analytics Tracking Enhancer (GATE) v4.8.3
 * Enhances and expands the tracking capabilities of Google Analytics.
 *
 * Distributed for use on approved client sites.
 *
 * Copyright (c) 2015 ROI Revolution, Inc.
 * For use only by active clients of ROI Revolution, Inc. on approved web
 * properties. Modification, redistribution, and/or attempted reverse engineering
 * of this script is strictly forbidden and may be subject to legal action.
 * http://www.roirevolution.com/
 */

/*! Modified from https://github.com/addyosmani/jquery.parts/blob/master/jquery.documentReady.js */
window.ROIStorage=window.ROIStorage||{};ROIStorage.GoogleAnalyticsObject=ROIStorage.GoogleAnalyticsObject||"ga";(function(h){var f=function(m){a(m);e()},j=h.document,i=false,g=[],a=function(m){if(typeof m==="function"){g.push(m)}},c=function(){while(g.length){(g.shift())()}a=function(m){m()}},l=function(){if(j.addEventListener){j.removeEventListener("DOMContentLoaded",l,false)}else{j.detachEvent("onreadystatechange",l)}b()},b=function(){if(!f.isReady){if(!j.body){return setTimeout(b,1)}f.isReady=true;c()}},e=function(){var m=false;if(i){return}i=true;if(j.readyState!=="loading"){b()}if(j.addEventListener){j.addEventListener("DOMContentLoaded",l,false);h.addEventListener("load",l,false)}else{if(j.attachEvent){j.attachEvent("onreadystatechange",l);h.attachEvent("onload",l);try{m=h.frameElement===null}catch(n){}if(j.documentElement.doScroll&&m){d()}}}},d=function(){if(f.isReady){return}try{j.documentElement.doScroll("left")}catch(m){setTimeout(d,1);return}b()},k=h.ROIStorage||{};f.isReady=false;k.runOnDocumentReady=f})(window);

/*! GATE */
(function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js",ROIStorage.GoogleAnalyticsObject);ROIStorage.clone=function(d){var e,c,b,a;if(null===d||"object"!==typeof d){return d}if(d instanceof Date){e=new Date();e.setTime(d.getTime());return e}if(d instanceof Array){e=[];for(c=0,a=d.length;c<a;c+=1){e[c]=ROIStorage.clone(d[c])}return e}if(d instanceof Object){e={};for(b in d){if(d.hasOwnProperty(b)){e[b]=ROIStorage.clone(d[b])}}return e}};(function(){var b=function(){window[ROIStorage.GoogleAnalyticsObject].apply(window,arguments)};window.roiTrackers={};function a(c){if(c.indexOf(".")===-1){return c}return c.split(".")[1]}if(typeof ROITracker!=="undefined"){return}ROIStorage.roiq.push(function(){var e=ROIStorage.GoogleAnalyticsObject,c;function d(f){if(f.indexOf(".")===-1){return roiTrackers[""]}return roiTrackers[f.split(".")[0]+"."]}window[e]=function(){var k,h,f,g,j,i=ROIStorage.clone(Array.prototype.slice.call(arguments,0));if(typeof arguments[0]==="function"){ROIStorage.realGa(arguments[0]);return}k=a(i[0]);h=d(i[0]);if(h&&k){f=h.getChildren();switch(k){case"create":break;case"set":if(h.isSetAllowed(i)){ROIStorage.realGa.apply(window,i);h.addToSetConfig(i)}break;case"send":h.runEnhancedEcommerce();if(h.isSendAllowed(i)){ROIStorage.realGa.apply(window,ROIStorage.clone(h.applySendConfig(i)));h.resetConfigs()}break;case"require":ROIStorage.realGa.apply(window,i);break;default:if(/^ecommerce:/i.test(k)){h.handleEcommerceMethod(i)}else{if(/^ec:/i.test(k)){h.handleEnhancedEcommerceMethod(i)}else{ROIStorage.realGa.apply(window,i)}}}for(g=0,j=f.length;g<j;g+=1){i[0]=f[g]+k;window[e].apply(window,i)}}};for(c in ROIStorage.realGa){if(ROIStorage.realGa.hasOwnProperty(c)){window[e][c]=ROIStorage.realGa[c]}}window[e].create=function(){}});window.ROITracker=function(d,j){var i=this,f={name:j?j+".":"",account:d||"",children:[],unnamedPageviewUsed:false,transactions:[],transCallBack:null,itemCallBack:null,completeCallBack:null,transPrefix:"",crossDomainEnabled:false,customTaggingParamNames:[],allowTrans:true,enhancedEcommerceTransactionId:null,enhancedEcommerceQueued:false,ecommerceToEc:false,nonReferralDomains:[]},e={name:j||""},c={},g={},h={handleAttribution:function(){var p=h.cpcCookieExists(),m=h.isCpcQuery(f.paidQueryRegex),o=h.firstCookieExists(),l=h.preserveAttribution,n=h.setCpcCookie,k=h.setFirstCookie;if(h.isNotDirectVisit()){if(f.firstTouch){if(f.cpcTrump){if(p){l();k()}else{if(m){n();k()}else{if(o){l()}else{k()}}}}else{if(o){l()}else{k()}}}else{if(f.cpcTrump){if(m){n()}else{if(p){l()}}}}}},cpcCookieName:"__roiCpc",firstCookieName:"__roiNonDirect",cpcCookieExists:function(){return ROITracker.getCookieValue(h.cpcCookieName)!==null},firstCookieExists:function(){return ROITracker.getCookieValue(h.firstCookieName)!==null},setCpcCookie:function(){ROIStorage.q.push([function(){ROITracker.setCookieAutoDomain(h.cpcCookieName,"true")}])},setFirstCookie:function(){ROIStorage.q.push([function(){ROITracker.setCookieAutoDomain(h.firstCookieName,"true")}])},isCpcQuery:function(l){var m=l||"gclid=|utm_medium=(?:cpc|ppc)",k=new RegExp("[?&#]("+m+")","i");return k.test(location.href)},isNotDirectVisit:function(){var m,n,k=false,l=new RegExp(h.getCustomParamRegexString(),"i");n=/utm_(?:source|id)|gclid/i.test(location.href)||l.test(location.href);if(document.referrer!==""){k=true;if(f.nonReferralDomains.length===0){f.nonReferralDomains.push(h.getCookieDomain())}for(m=0;m<f.nonReferralDomains.length;m+=1){if(document.referrer.indexOf(f.nonReferralDomains[m])!==-1){k=false;break}}}return(n||k)},refreshFlagCookies:function(){if(h.firstCookieExists()){h.setFirstCookie()}if(h.cpcCookieExists()){h.setCpcCookie()}},preserveAttribution:function(){c.referrer="";g.location=h.getStrippedPage()},getStrippedPage:function(){var k=h.getCustomParamRegexString(),m,l=(location.search).replace(/[?&](?:gclid|utm_(?:source|medium|campaign|content|term|id))=[^&]*/ig,"");if(k!==null){m=new RegExp("[?&](?:"+k+")=[^&]*","ig");l=l.replace(m,"")}l=l.replace(/^&/,"?");return location.protocol+"//"+location.hostname+location.pathname+l},getCustomParamRegexString:function(){var k=f.customTaggingParamNames;if(k.length>0){return k.join("|")}return null},addNewParamKey:function(m,k){var l=(h.getCurrentQueryString()).replace(m,k);g.location=location.protocol+"//"+location.hostname+location.pathname+l;f.customTaggingParamNames.push(m)},getCurrentQueryString:function(){var k=g.location||document.location,l=/(\?.*)(?:$|#)/.exec(k);return l?l[1]:""},storeAttributionPreferences:function(l,m,k,o,n){f.cpcTrump=l||false;f.firstTouch=m||false;f.legacyCookieNamespace=k;f.paidQueryRegex=o;f.paidCookieRegex=n},hasPropertyBesides:function(k,l){var m;for(m in k){if(k.hasOwnProperty(m)){if(!h.arrayContains(l,m)){return true}}}return false},arrayContains:function(m,l){var k;for(k=0;k<m.length;k+=1){if(l===m[k]){return true}}return false},storeTransaction:function(k){var l,m=h.getStoredTransaction(k.id);if(m!==null){for(l in k){if(k.hasOwnProperty(l)){m[l]=k[l]}}}else{f.transactions.push(k)}},storeTransactionItem:function(k){var l=h.getStoredTransaction(k.id);if(l!==null){l.orderItems=l.orderItems||[];l.orderItems.push(k)}else{f.transactions.push({id:k.id,orderItems:[k]})}},getStoredTransaction:function(m){var k,l;for(k=0,l=f.transactions.length;k<l;k+=1){if(f.transactions[k].id===m){return f.transactions[k]}}return null},doConvertEcommerceToEc:function(o){b("require","ec");var m=o[0].split(":")[1],k;switch(m){case"addTransaction":k=[f.name+"ec:setAction","purchase",o[1]];break;case"addItem":k=[f.name+"ec:addProduct",o[1]];var l=o[1].name,n=o[1].SKU;if(n){k[1].id=n}else{k[1].name=l;k[1].id=""}break;case"send":k="send";break;case"clear":k=[f.name+"ec:clear"];break;default:k=o}return k},executeTransCallBack:function(){var n,l,o,k,q,p,m;for(n=0,p=f.transactions.length;n<p;n+=1){q=f.transactions[n];if(h.isFunction(f.transCallBack)){f.transCallBack(q.revenue,q.id,q.tax,q.shipping)}k=q.orderItems;if(f.itemCallBack&&k){for(l=0,m=k.length;l<m;l+=1){o=k[l];if(h.isFunction(f.itemCallBack)){f.itemCallBack(q.revenue,q.id,o.sku,o.quantity,o.name,o.category,o.price)}}}}if(h.isFunction(f.completeCallBack)){f.completeCallBack()}f.transactions=[]},isFunction:function(k){return typeof k==="function"},applyTransPrefix:function(k){k.id=f.transPrefix+k.id},ensureCookieDomainConfigSet:function(){if(!e.hasOwnProperty("cookieDomain")){e.cookieDomain="auto"}},linkingRegex:/^(?:__roi|__utmx(?:x|_k)?|zma[cgkp]|kw|sid)/,setWindowName:function(){var s=document.cookie.split("; "),q=s.length,m=[],l=window.name.split(/;\s*/),o,r,p,k,n;for(n=0;n<l.length;n+=1){o=l[n];r=h.getSplitCookie(o);if(r!==null){p=r[0];k=r[1];if(!(h.linkingRegex.test(p)||ROITracker.isGaCookie(k))){m.push(o)}}else{if(o!==""){m.push(o)}}}for(n=0;n<q;n+=1){r=h.getSplitCookie(s[n]);if(r!==null){p=r[0];k=r[1];if(h.linkingRegex.test(p)||ROITracker.isGaCookie(k)){m.push(s[n])}}}window.name=m.join("; ")+";"},readWindowName:function(){var l,n,o,q,p,k,m;l=window.name.split(/;\s*/);for(m=0,n=l.length;m<n;m+=1){o=h.getSplitCookie(l[m]);if(o!==null){q=o[0];p=o[1];if(h.linkingRegex.test(q)){ROITracker.setCookieAutoDomain(q,p)}else{if(q==="_ga"&&ROITracker.isGaCookie(p)){k=ROITracker.getClientId(p);if(k!==null){e.clientId=k}}}}}},getSplitCookie:function(k){var l=/^([^=]+)=(.+)$/.exec(k);if(l&&l[1]&&l[2]){return[l[1],l[2]]}return null},handleLegacyCookies:function(){function l(){var v=document.cookie.split("; "),s=v.length,w={},u,t;for(t=0;t<s;t+=1){u=(/^(2?__utm[za](?:_[a-z_\-]+)?)=(.+)$/).exec(v[t]);if(u){w[u[1]]=u[2]}}return w}function k(v,u){var t,s=v+"="+u;t=/^(?:2__utm[za]=\^([a-z_\-]+)\.|__utm[za]_([a-z_\-]+)=)/.exec(s);if(t){return(t[1]||t[2])===f.legacyCookieNamespace}return false}function r(s){return(/(__utm[za])/).exec(s)[1]}function q(s){return s.replace(/\^[a-z_\-]+\.\d+:/i,"")}function m(v){var t=f.firstTouch&&f.cpcTrump,s=!/utmcsr=\(direct\)/.test(v),u=(f.paidCookieRegex?new RegExp(f.paidCookieRegex,"i"):/utmgclid=|utmcmd=(cpc|ppc)/).test(v);if(t&&u){h.preserveAttribution();h.setFirstCookie();h.setCpcCookie()}else{if(f.firstTouch&&s){h.preserveAttribution();h.setFirstCookie()}}}var p,o,n;if(f.legacyCookieNamespace!==undefined){n=l();for(p in n){if(n.hasOwnProperty(p)){o=n[p];if(k(p,o)){ROITracker.setCookieAutoDomain(r(p),q(o));m(o);h.breakCookie(p)}}}}ROIStorage.q.push([function(){h.breakCookie("__utma");h.breakCookie("__utmz")}])},breakCookie:function(k){ROITracker.setCookieAutoDomain(k,"delete",0)},mergeObjects:function(l,m){var k;for(k in l){if(l.hasOwnProperty(k)){m[k]=l[k]}}return m},trackFacebook:function(){var k=window.fbAsyncInit;window.fbAsyncInit=function(){var l=window.FB;if(typeof k==="function"){k()}try{if(l&&l.Event&&l.Event.subscribe){l.Event.subscribe("edge.create",function(n){b("send","social","facebook","like",n)});l.Event.subscribe("edge.remove",function(n){b("send","social","facebook","unlike",n)});l.Event.subscribe("message.send",function(n){b("send","social","facebook","send",n)})}}catch(m){}}},trackTwitter:function(){var k=window.twttr;if(typeof k==="undefined"){return}k.ready(function(l){l.events.bind("tweet",function(m){if(m){b("send","social","twitter","tweet",location.href)}});l.events.bind("follow",function(m){if(m){b("send","social","twitter","follow",location.href)}})})},trickle:function(n,k){var m,o,l;for(m=0,o=f.children.length;m<o;m+=1){l=roiTrackers[f.children[m]];l[n].apply(l,k)}},getCookieDomain:function(){if(e.cookieDomain&&e.cookieDomain!=="auto"&&e.cookieDomain!=="none"){return e.cookieDomain}return ROITracker.setCookieAutoDomain("roiDomain","1")}};this.setAttributionModel=function(k,m,n,l,o){h.storeAttributionPreferences(k,m,n,l,o);h.refreshFlagCookies()};this.isSendAllowed=function(l){var k,m=l[1];if(m==="pageview"){if(l[2]===undefined){if(!f.unnamedPageviewUsed){f.unnamedPageviewUsed=true;return true}return false}return true}if(typeof m==="object"&&m.hitType==="pageview"){if(!h.hasPropertyBesides(m,["hitType"])){return false}if(m.page&&m.page!==""){return true}k=!f.unnamedPageviewUsed;f.unnamedPageviewUsed=true;if(h.hasPropertyBesides(m,["hitType","page"])){return true}return k}return true};this.isSetAllowed=function(l){function k(n){return/^campaign(?:Name|Source|Medium|Keyword|Content|Id)$/i.test(n)}var m=l[1];if(k(m)||m==="location"||m==="referrer"){return false}return true};this.applySendConfig=function(m){var l=Array.prototype.slice.call(m,0),k=l.length;if(typeof l[1]==="object"){l[1]=h.mergeObjects(l[1],g)}else{if(typeof l[k-1]==="object"){l[k-1]=h.mergeObjects(l[k-1],g)}else{if(l[1]==="pageview"){if(k===2){l.push(g)}else{if(typeof l[2]==="string"){g.hitType="pageview";g.page=l[2];l[2]=g}else{l.push(g)}}}else{l.push(g)}}}return l};this.addToSetConfig=function(k){if(typeof k[1]==="object"){h.mergeObjects(k[1],c)}else{if(typeof k[1]==="string"&&typeof k[2]==="string"){c[k[1]]=k[2]}}};this.resetConfigs=function(){g={};c={};h.handleAttribution()};this.convertEcommerceToEc=function(){f.ecommerceToEc=true;h.trickle("convertEcommerceToEc")};this.handleEcommerceMethod=function(k){if(f.ecommerceToEc){k=h.doConvertEcommerceToEc(k);if(k!=="send"){this.handleEnhancedEcommerceMethod(k)}else{b("send","pageview")}}else{if(f.allowTrans){switch(k[0]){case"ecommerce:addTransaction":h.applyTransPrefix(k[1]);h.storeTransaction(k[1]);break;case"ecommerce:addItem":h.applyTransPrefix(k[1]);h.storeTransactionItem(k[1]);break;case"ecommerce:send":h.executeTransCallBack();break;case"ecommerce:clear":f.transactions=[];break}ROIStorage.realGa.apply(window,k)}}};this.runEnhancedEcommerce=function(){if(f.enhancedEcommerceQueued){if(f.allowTrans&&f.enhancedEcommerceTransactionId){h.getStoredTransaction("EC").id=f.enhancedEcommerceTransactionId;h.executeTransCallBack();f.enhancedEcommerceTransactionId=null}f.transactions=[];ROIStorage.realGa(f.name+"send","event","Ecommerce","Action",{nonInteraction:1})}f.enhancedEcommerceQueued=false};this.handleEnhancedEcommerceMethod=function(n){var k,l="EC",o=a(n[0]),m=o==="ec:setAction"&&n[1]==="purchase";f.enhancedEcommerceQueued=true;if(o==="ec:addProduct"){k=ROIStorage.clone(n[1]);k.sku=k.id;k.id=l;h.storeTransactionItem(k)}else{if(o==="ec:clear"){f.transactions=[];f.enhancedEcommerceQueued=false}else{if(m){h.applyTransPrefix(n[2]);k=ROIStorage.clone(n[2]);f.enhancedEcommerceTransactionId=k.id;k.id=l;h.storeTransaction(k)}}}if(!m||f.allowTrans){ROIStorage.realGa.apply(window,n)}};this._setCampSourceKey=function(k){if(ROITracker.getQueryParameter(k)!==null){h.addNewParamKey(k,"utm_source");h.trickle("_setCampSourceKey",arguments)}};this._setCampMediumKey=function(k){if(ROITracker.getQueryParameter(k)!==null){h.addNewParamKey(k,"utm_medium");h.trickle("_setCampMediumKey",arguments)}};this._setCampTermKey=function(k){if(ROITracker.getQueryParameter(k)!==null){h.addNewParamKey(k,"utm_term");h.trickle("_setCampTermKey",arguments)}};this._setCampContentKey=function(k){if(ROITracker.getQueryParameter(k)!==null){h.addNewParamKey(k,"utm_content");h.trickle("_setCampContentKey",arguments)}};this._setCampNameKey=function(k){if(ROITracker.getQueryParameter(k)!==null){h.addNewParamKey(k,"utm_campaign");h.trickle("_setCampNameKey",arguments)}};this._setVisitorCookieTimeout=function(k){e.cookieExpires=k/1000;h.trickle("_setVisitorCookieTimeout",arguments)};this._setAllowLinker=function(k){e.allowLinker=k;h.trickle("_setAllowLinker",arguments)};this._setSiteSpeedSampleRate=function(k){e.siteSpeedSampleRate=k;h.trickle("_setSiteSpeedSampleRate",arguments)};this._trackEvent=function(l,m,n,k){b("send","event",l,m,n,k)};this._addTrans=function(k,n,o,m,l){b("require","ecommerce","ecommerce.js");b("ecommerce:addTransaction",{id:k,affiliation:n,revenue:o,tax:m,shipping:l})};this._addItem=function(k,p,l,n,m,o){b("ecommerce:addItem",{id:k,sku:p,name:l,category:n,price:m,quantity:o})};this._trackTrans=function(){b("ecommerce:send")};this._clearTrans=function(){b("ecommerce:clear")};this.setTransCallBack=function(m,l,k){f.transCallBack=m;f.itemCallBack=l;f.completeCallBack=k};this.setTransPrefix=function(k){f.transPrefix=k};this.setAllowTrans=function(k){f.allowTrans=k;h.trickle("setAllowTrans",arguments)};this.trackTransForm=function(){ROIStorage.runOnDocumentReady(function(){ROIStorage.q.push([function(){var n,k,m,o,l=document.getElementById("utmtrans");if(l===null){return}b("require","ecommerce","ecommerce.js");n=l.innerHTML.trim().replace(/\n/g,"").split("UTM:");for(o=0,k=n.length;o<k;o+=1){if(n[o]){m=n[o].split("|");if(m[0]==="T"){b("ecommerce:addTransaction",{id:m[1],affiliation:m[2],revenue:m[3],tax:m[4],shipping:m[5]})}else{if(m[0]==="I"){b("ecommerce:addItem",{id:m[1],sku:m[2],name:m[3],category:m[4],price:m[5],quantity:m[6]})}}}}b("ecommerce:send")}])})};this.setCustomData=function(k,l){c[k]=l;h.trickle("setCustomData",arguments)};this.setReferrerCustomDimension=function(n){var k=document.referrer,l=/^https?:\/\/([^\/]+)\//i;function m(r,p){var o,q;for(o=0;o<r.length;o+=1){q=r[o];if(q.substring(0,1)!=="."){q="."+q}if(p.indexOf(q)!==-1){return true}}return false}if(k!==""){k=l.exec(k);if(k&&k[1]){k=k[1];if(!m(f.nonReferralDomains,k)&&!/paypal\.com|netsuite\.com|shopify\.com|bigcommerce/i.test(k)){this.setCustomData("dimension"+n,k.replace(/^www\./,""))}}}};this.trackSocial=function(){ROIStorage.runOnDocumentReady(function(){h.trackFacebook();h.trackTwitter()})};this.getChildren=function(){return f.children};this.setDomainNames=function(k){f.crossDomainEnabled=true;f.nonReferralDomains=k;h.trickle("setDomainNames",arguments)};this._setDomainName=function(k){e.cookieDomain=k;f.nonReferralDomains=[k];h.trickle("_setDomainName",arguments)};this._trackPageview=function(l){var k=(f.name!==""),n=(f.name===""&&f.children.length===0),m=(f.account!=="");ROIStorage.roiq.push(function(){if(m){h.handleLegacyCookies();h.handleAttribution();h.ensureCookieDomainConfigSet();if(f.crossDomainEnabled){h.readWindowName()}ROIStorage.realGa("create",f.account,e);ROIStorage.realGa(f.name+"require","displayfeatures");ROIStorage.realGa(f.name+"require","linkid","linkid.js");ROIStorage.realGa(f.name+"set",c);if(l!==false&&l!==undefined){g.page=l;ROIStorage.realGa(f.name+"send","pageview",ROIStorage.clone(g))}else{if(l!==false&&!f.unnamedPageviewUsed){f.unnamedPageviewUsed=true;ROIStorage.realGa(f.name+"send","pageview",g)}}i.resetConfigs();if(f.crossDomainEnabled&&(k||n)){h.setWindowName()}}});h.trickle("_trackPageview",arguments)};this.useBeacon=function(){i.setTransportMethod("beacon");h.trickle("useBeacon",arguments)};this.setTransportMethod=function(k){if(!(k==="beacon"||k==="image"||k==="xhr")){return}g.transport=k;h.trickle("setTransportMethod",arguments)};this.createTracker=function(k,m){var l=new ROITracker(k,m);i.addTracker(l);return l};this.addTracker=function(k){f.children.push(k.getName())};this.getName=function(){return f.name};roiTrackers[f.name]=this};ROITracker.setCookieAutoDomain=function(e,k,h){var c=document.domain.split("."),j=c[c.length-1],g=false,f=2,d="junk";while(!g&&f<=c.length){j=c[c.length-f]+"."+j;ROITracker.setCookie(e,d,h,j);g=ROITracker.setCookie(e,k,h,j);f+=1}if(!g){ROITracker.setCookie(e,k,h);return location.hostname}else{return j}};ROITracker.setCookie=function(d,g,f,e){var c=new Date(),h=g.toString().replace(/;/g,function(i){return window.encodeURIComponent(i)});c.setDate(c.getDate()+(f!==undefined?f:364/2));h+="; expires="+c.toUTCString();h+=((e===undefined)?"":"; domain="+e);h+="; path=/";document.cookie=d+"="+h;return ROITracker.getCookieValue(d)===g.toString()};ROITracker.setSessionCookie=function(c,e,d){var f=e.toString().replace(/;/g,function(g){return window.encodeURIComponent(g)});f+=((d===undefined)?"":"; domain="+d);f+="; path=/";document.cookie=c+"="+f;return ROITracker.getCookieValue(c)===e.toString()};ROITracker.getCookieValue=function(d){var e=new RegExp("(?:^|; )"+d+"=([^;]+)"),c=e.exec(document.cookie);if(c&&c[1]){return window.decodeURIComponent(c[1])}return null};ROITracker.getCookie=function(c){return ROITracker.getCookieValue(c)};ROITracker.trackAdWordsConversion=function(i,e,h,c){var d=new Image(),g=location.protocol+"//www.googleadservices.com/pagead/conversion/"+i+"/",j=new Date(),f=document.getElementsByTagName("script")[0];g+="?random="+j.getTime();g+="&cv=7";g+="&fst="+j.getTime();g+="&num=1";g+="&fmt=3";g+=(h>0)?"&value="+h:"";g+=(c!==undefined)?"&currency_code="+c:"";g+="&label="+e;g+="&guid=ON";g+="&bg=ffffff";g+="&hl=en";g+="&gl=US";g+="&url="+window.escape(location.href.toString().substring(0,256));g+="&frm=0";d.height="1";d.width="1";d.style.borderStyle="none";d.alt="";d.src=g;f.parentNode.insertBefore(d,f)};ROITracker.trackAdWordsRemarketing=function(g,d){var c=new Image(),f=location.protocol+"//googleads.g.doubleclick.net/pagead/viewthroughconversion/"+g+"/",e=document.getElementsByTagName("script")[0];f+="?value=0";f+="&label="+d;f+="&guid=ON";f+="&script=0";c.height="1";c.width="1";c.style.borderStyle="none";c.alt="";c.src=f;e.parentNode.insertBefore(c,e)};ROITracker.trackDynamicRemarketing=function(c){ROIStorage.runOnDocumentReady((function(d){return function(){var e=new Image(),i=location.protocol+"//googleads.g.doubleclick.net/pagead/viewthroughconversion/"+d+"/",h=document.getElementsByTagName("script")[0],j=new Date(),g,f;i+="?random="+j.getTime();i+="&cv=7";i+="&fst="+j.getTime();i+="&num=1";i+="&fmt=1";i+="&guid=ON";i+="&url="+window.escape(location.href.toString().substring(0,256));if(typeof window.google_tag_params==="object"){g="";for(f in window.google_tag_params){if(window.google_tag_params.hasOwnProperty(f)){g+=f+"="+window.google_tag_params[f]+";"}}i+="&data="+window.escape(g.substring(0,g.length-1))}e.height="1";e.width="1";e.style.borderStyle="none";e.alt="";e.src=i;h.parentNode.insertBefore(e,h)}}(c)))};ROITracker.trackMSNConversion=function(i,h,f,d,g){var c=new Image(),e=document.getElementsByTagName("script")[0],j;f=f||"";d=d||"";g=g||"";j=location.protocol+"//"+i+".r.msn.com/?type=1&domainId="+i+"&dedup=1&actionid="+h+"&revenue="+f+"&taxcost="+d+"&shippingcost="+g;c.height="1";c.width="1";c.style.borderStyle="none";c.alt="";c.src=j;e.parentNode.insertBefore(c,e)};ROITracker.trackBingConversion=ROITracker.trackMSNConversion;ROITracker.trackUETMSNPageview=function(g,f){if(typeof window.uetq==="undefined"){var c,d,e;window.uetq=window.uetq||[];c=function(){var h={ti:g,q:window.uetq};window.uetq=new UET(h);window.uetq.push("pageLoad")};d=document.createElement("script");d.src="//bat.bing.com/bat.js";d.async=1;d.onload=d.onreadystatechange=function(){var h=this.readyState;if(!h||h==="loaded"||h==="complete"){c();d.onload=d.onreadystatechange=null}};document.getElementsByTagName("script")[0].parentNode.insertBefore(d,e)}else{window.uetq.push("pageLoad")}if(f||f===0){window.uetq.push({ec:"conversion",gv:f})}};ROITracker.trackUETBingPageview=ROITracker.trackUETMSNPageview;ROITracker.trackUETMSNConversion=function(d,c){ROITracker.trackUETMSNPageview(d,c||0)};ROITracker.trackUETBingConversion=ROITracker.trackUETMSNConversion;ROITracker.trackGeminiConversion=function(d,c){var e=new Image(),f=document.getElementsByTagName("script")[0],g="//sp.analytics.yahoo.com/sp.pl";g+="?a="+d;g+="&.yp="+c;g+="&b="+encodeURIComponent(document.title);g+="&f="+encodeURIComponent(location.href);e.height="1";e.width="1";e.style.borderStyle="none";e.alt="";e.src=g;f.parentNode.insertBefore(e,f)};ROITracker.setMerchantAdvantageCookies=function(c){window._maCookieDays=c||30;if(/zmam=/i.test(location.search)){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src=(document.location.protocol=="https:"?"https://secure":"http://chanalytics")+".merchantadvantage.com/inchannel/maclick.js";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(e,d)}};ROITracker.trackMerchantAdvantageItem=function(j,c,i,f,g,e){var k,d=new Image(),h=(document.location.protocol==="https:"?"https://secure":"http://chanalytics")+".merchantadvantage.com/inChannel/cap2q_new.asp",m=document.getElementsByTagName("script")[0],l=(function(){function n(){var o={};o.zmap=ROITracker.getCookieValue("zmap")||"0";o.zmac=ROITracker.getCookieValue("zmac")||"0";o.sid=ROITracker.getCookieValue("sid")||"0";o.zmag=ROITracker.getCookieValue("zmag")||"0";o.zmak=ROITracker.getCookieValue("zmak")||"0";o.kw=ROITracker.getCookieValue("kw")||"0";o.zmar=document.referrer.substring(0,2000);return o}if(typeof ROITracker.merchantAdvantageCookies==="object"){return ROITracker.merchantAdvantageCookies}ROITracker.merchantAdvantageCookies=n();return ROITracker.merchantAdvantageCookies}());h+="?zmam="+g;h+="&zmas="+e;for(k in l){if(l.hasOwnProperty(k)&&k!=="zmap"){h+="&"+k+"="+l[k]}}h+="&zmat="+j;h+="&zman="+c;h+="&zmap="+i;h+="&qty="+f;h+="&zmaq=N";d.height="0";d.width="0";d.style.borderStyle="none";d.alt="";d.src=h;m.parentNode.insertBefore(d,m)};ROITracker.trackFacebookConversion=function(g,f){var c=new Image(),e=document.getElementsByTagName("script")[0],d="https://www.facebook.com/tr";d+="?ev="+g;d+="&dl="+encodeURIComponent(document.location);d+="&rl="+encodeURIComponent(document.referrer);d+="&cd[value]="+(f!==undefined?f:0);d+="&cd[currency]=USD";d+="&ts="+new Date().getTime();c.height="1";c.width="1";c.style.borderStyle="none";c.alt="";c.src=d;e.parentNode.insertBefore(c,e)};ROITracker.trackFacebookAudience=function(c){var d=new Image(),g=document.getElementsByTagName("script")[0],f="https://www.facebook.com/tr",e=window.top!==window;f+="?id="+c;f+="&ev=PixelInitialized";f+="&if="+e;f+="&dl="+encodeURIComponent(document.location);f+="&rl="+encodeURIComponent(document.referrer);f+="&ts="+new Date().getTime();d.height="1";d.width="1";d.style.borderStyle="none";d.alt="";d.src=f;g.parentNode.insertBefore(d,g)};ROITracker.trackAdRoll=function(c,f,e,d){ROIStorage.runOnDocumentReady(function(){window.adroll_adv_id=c;window.adroll_pix_id=f;if(typeof e!=="undefined"){window.adroll_conversion_value_in_dollars=e}if(typeof d!=="undefined"){window.adroll_custom_data={ORDER_ID:d}}window.__adroll_loaded=true;var h=document.createElement("script"),g=(("https:"===document.location.protocol)?"https://s.adroll.com":"http://a.adroll.com");h.setAttribute("async","true");h.type="text/javascript";h.src=g+"/j/roundtrip.js";((document.getElementsByTagName("head")||[null])[0]||document.getElementsByTagName("script")[0].parentNode).appendChild(h)})};ROITracker.getQueryParameter=function(d){var e=new RegExp("(?:[?&#])"+d+"=([^&#]+)"),c=e.exec(location.search+location.hash);if(c){return window.unescape(c[1])}return null};ROITracker.clickHandler=function(d,e){return function c(){var g=this,f=!d(g);if(f){setTimeout(function(){if(typeof e==="function"){e()}location.href=g.href;if(g.click){g.onclick="";g.click()}},300);return false}if(typeof e==="function"){e()}return true}};ROITracker.submitHandler=function(e,d){return function c(){var h=this,g,f;if(!d||(f=d())||f===undefined){g=!e(h);if(g){setTimeout(function(){h.submit()},300)}else{return true}}return false}};ROITracker.gaCookieValueRegex=/^GA\d+\.\d+\.(\d+\.\d+)$/;ROITracker.isGaCookie=function(c){return ROITracker.gaCookieValueRegex.test(c)};ROITracker.getClientId=function(e){var c=e||ROITracker.getCookieValue("_ga"),d=ROITracker.gaCookieValueRegex.exec(c);if(d&&d[1]){return d[1]}return null};ROITracker.crmTracking=function(d,c,e){ROIStorage.runOnDocumentReady(function(){ROIStorage.q.push([function(){var m=ROITracker.getQueryParameter,l=ROITracker.getCookieValue,f=function(){var o=/[?&](?:q|p|query|encquery|qt|terms|rdata|qs|wd|text|szukaj|k|searchExpr|search_for|string|search_query|searchfor)=([^&]+)/,p=o.exec(document.referrer);if(p){return window.unescape(p[1])}return null},g=function(){var r,q,o,p=new Date();r=p.getFullYear().toString();q=(p.getMonth()+1).toString();o=p.getDate().toString();return r+(q.charAt(1)?q:"0"+q.charAt(0))+(o.charAt(1)?o:"0"+o.charAt(0))},n={cookieName:"__roia",fieldName:c||"roi_visitor",fieldValue:{id:ROITracker.getClientId(),fvisitdate:g(),fquery:f(),freferrer:document.referrer,flanding:location.pathname},extraValues:{form:location.pathname,gwo:l("__utmx")}},h={cookieName:"__roiz",fieldName:e||"roi_attribution",fieldValue:{clickdate:g(),source:m("gclid")?"google":m("utm_source"),medium:m("gclid")?"cpc":m("utm_medium"),campaign:m("ga_campaign")||m("utm_campaign"),adgroup:m("ga_adgroup")||m("utm_content"),creative:m("ga_creative")||m("utm_creative"),keyword:m("ga_keyword")||m("utm_term"),device:m("ga_device")||m("utm_device"),network:m("ga_network"),query:f(),referrer:document.referrer,landing:location.pathname},updateCondition:m("gclid")||m("utm_source")},k=function(o){var s,q;function p(v){var t,u="";for(t in v){if(v.hasOwnProperty(t)){u+="|";u+=t;u+="=";u+=v[t]?(v[t].toString()).substring(0,60):""}}u=u.substring(1);return u}function r(u){var t;for(t in u){if(u.hasOwnProperty(t)){u[t]=""}}return p(u)}this.addHiddenInput=function(u){var t;if(u[o.fieldName]){u[o.fieldName].value=window.unescape(q)}else{t=document.createElement("input");t.name=o.fieldName;t.value=window.unescape(q);t.type="hidden";u.appendChild(t)}};s=p(o.fieldValue);q="";if(!l(o.cookieName)&&(o.updateCondition!==undefined?o.updateCondition:true)){ROITracker.setCookieAutoDomain(o.cookieName,s,365)}q=l(o.cookieName)||r(o.fieldValue);if(o.extraValues!==undefined){q+="|";q+=p(o.extraValues)}},i=new k(n),j=new k(h);(function(){var q,p,o;for(q=0,o=d.length;q<o;q+=1){p=document.forms[d[q]]||document.getElementById(d[q]);if(p){i.addHiddenInput(p);j.addHiddenInput(p)}}})()}])})};ROITracker.processQueuedCommands=function(){var g=function(h){var k,j;function i(l){if(l.indexOf(".")===-1){return""}return l.split(".")[0]+"."}if(typeof h==="function"){ROIStorage.runOnDocumentReady(h);return}k=a(h[0]);j=i(h[0]);switch(k){case"_addTrans":b(j+"require","ecommerce","ecommerce.js");b(j+"ecommerce:addTransaction",{id:h[1],affiliation:h[2],revenue:h[3],tax:h[4],shipping:h[5]});break;case"_addItem":b(j+"ecommerce:addItem",{id:h[1],sku:h[2],name:h[3],category:h[4],price:h[5],quantity:h[6]});break;case"_trackTrans":b(j+"ecommerce:send");break;case"_trackEvent":b(j+"send","event",{eventCategory:h[1],eventAction:h[2],eventLabel:h[3],eventValue:h[4]});break;case"_trackPageview":b(j+"send",{hitType:"pageview",page:h[1]});break;case"_trackSocial":b(j+"send","social",{socialNetwork:h[1],socialAction:h[2],socialTarget:h[3]});break;case"_trackTiming":b(j+"send","timing",{timingCategory:h[1],timingVar:h[2],timingValue:h[3],timingLabel:h[4]});break;case"_link":location.href=h[1];break;case"_setCustomVar":if(ROITracker.customVarMap){b(j+"set",ROITracker.customVarMap[h[1]],h[3])}break}};function d(){var h;if(typeof ROIStorage.q==="object"){for(h=0;h<ROIStorage.q.length;h+=1){b.apply(window,ROIStorage.q[h])}ROIStorage.q=[]}}function e(){ROIStorage.q.push=function(h){b.apply(window,h)}}function f(){var h;if(typeof ROIStorage.gaq==="object"){for(h=0;h<ROIStorage.gaq.length;h+=1){g(ROIStorage.gaq[h])}ROIStorage.gaq=[]}}function c(){ROIStorage.gaq.push=function(h){g(h)}}ROIStorage.roiq.push(function(){d();e();f();c()})};(function(d){var g,e,f,c=ROITracker.getClientId();if(Math.random()<0.01&&typeof window.XMLHttpRequest==="function"&&c!==null){g=location.protocol;e=g==="http:"?g+"//www":g+"//ssl";e+=".google-analytics.com/collect?v=1&tid="+d+"&t=pageview";e+="&cid="+c;e+="&dl="+encodeURIComponent(document.URL);e+="&z="+Math.round((Math.random()+0.1)*1000000000);f=new XMLHttpRequest();f.open("GET",e,true);f.send()}})("UA-61700779-1")}());

/*
 * ******
 * DO NOT UPDATE LIBRARY UNTIL WE CAN HANDLE MULTIPLE ENHANCED ECOMMERCE TRANSACTIONS
 * ******
 */

var pageTracker;

if (/store-test/i.test(location.hostname)) {
    pageTracker = new ROITracker('UA-15932749-4', '');
} else if (/ssiinst2/i.test(location.hostname)) {
    pageTracker = new ROITracker('UA-15932749-36', '');
    pageTracker.createTracker('UA-51700107-21', 't1');
    pageTracker.createTracker('UA-51700107-15', 't2');
} else {
    pageTracker = new ROITracker('UA-15932749-6', '');
    pageTracker.createTracker('UA-51700107-5', 't1');
    pageTracker.createTracker('UA-51700107-2', 't2');
    pageTracker.createTracker('UA-51700107-24', 't3').setAttributionModel(true, true, 'first_cpc');

    // roll-up
    pageTracker.createTracker('UA-51700107-29', 't4');
    pageTracker.createTracker('UA-51700107-30', 't5').setAttributionModel(true, true, 'first_cpc');
}
pageTracker.setDomainNames(['schoolspecialty.com', 'sparkpe.org']);

// PDF Lesson plan download event tracking
ROIStorage.runOnDocumentReady(function() {
    var selector = 'a[href*="GetWCCFile.jsp?"]',
        links,
        link,
        i;

    function getNewOnclick(linkText, oldOnclick) {
        return function() {
            pageTracker._trackEvent('Lesson Plan Download', linkText);
            if (typeof oldOnclick === 'function') {
                return oldOnclick();
            }
        }
    }

    if (typeof document.querySelectorAll === 'function') {
        links = document.querySelectorAll(selector);
    } else if (typeof jQuery === 'function') {
        links = jQuery(selector)
    } else {
        return;
    }

    for (i = 0; i < links.length; i += 1) {
        link = links[i];
        link.onclick = getNewOnclick(link.text, link.onclick);
    }

});

pageTracker._trackPageview();
ROITracker.trackAdWordsRemarketing('1022230658', '1f3ACJXg41wQgoG45wM');
ROITracker.processQueuedCommands();
