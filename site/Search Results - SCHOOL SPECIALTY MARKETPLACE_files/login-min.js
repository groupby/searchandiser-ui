YUI.namespace("com.schoolspecialty.ebs.iStore.login.app").doLoginFormSubmit=function(formName){if(typeof YUI!="undefined"){YUI().use("node","io","json-parse","panel",function(Y){var waitPanel=new Y.Panel({srcNode:"waitPanel",headerContent:"Please wait while we access your account.",bodyContent:'<div align="center"><img src="/OA_HTML/xxssi/iStore/vic-animation3.gif"/></div>',modal:true,close:false,centered:true,zIndex:10000,buttons:[],hideOn:[]});YUI.com.schoolspecialty.ebs.istore.alwaysCenter(waitPanel);waitPanel.render();var addMask=function(context){if(null==Y.one(".window-mask")){context.prepend("<div class='window-mask' id='waitPanelMask'></div>");}return"window-mask";};var removeMask=function(maskClass){hv.maskNode=Y.one("."+maskClass);if(hv.maskNode!=null){hv.maskNode.remove();}};Y.io("/OA_HTML/xxssi_ibeLoginStore.jsp",{method:"POST",form:document.forms[formName],on:{success:function(id,o){var resp=Y.JSON.parse(o.responseText);var ref=resp.ref;if(ref.indexOf("http://")==0){ref="https://"+ref.substring(7);}if(resp.errmsg&&resp.errmsg!=null&&!resp.errmsg==""){var errorMessage=document.getElementById("com.schoolspecialty.ebs.iStore.login.errormessages");errorMessage.innerHTML=resp.errmsg;waitPanel.hide();}else{if(resp.valid){if(resp.ref==""){window.location.reload(true);}else{window.location=ref;}}else{window.location=ref;}}if(Y.one("#js-login-dialog")&&Y.one("#js-login-dialog").hasClass("yui3-panel-content")){addMask(Y.one(document.body));}},failure:function(id,result){waitPanel.hide();alert("An error has occurred, please try again later or contact Customer Care");}}});});}else{Y.log("YUI is not loaded in login and registration page.");}};